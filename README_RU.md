# Решение тестового задания.
# Выбранные стеки
Использовался стек Django с PostgreSQL (БД стартует в отдельном контейнере, нужно убедится что порт 5432 не занят.)

## Запуск проекта
Для запуска локального сервера:

    git clone https://github.com/Swich1987/TestAppFollow.git
    cd TestAppFollow
    docker-compose up

При запуске будет создана задача по загрузке новостей с hackernews, которая будет выполняться 1 раз в минуту. Настроить время обновлений можно в файле `loop_parsing.py`.
Также, перед запуском сервера запускаются внутрение тесты Django из файла `tests.py`

После запуска сервер доступен по ссылке:

<http://127.0.0.1:8000/posts>

Примеры запросов:
- <http://127.0.0.1:8000/posts?order=-id>
- <http://127.0.0.1:8000/posts?limit=25>
- <http://127.0.0.1:8000/posts?offset=10>
- <http://127.0.0.1:8000/posts?order=-id&limit=25&offset=10>

Для запуска удаленного сервера, на который нужен доступ с других машин, нужно добавить адрес этого сервера в параметр `ALLOWED_HOSTS`, находящийся в файле `settings.py`.


## Публичная копия сервера
Публичная копия сервера доступна по ссылке:

<http://ec2-18-218-151-219.us-east-2.compute.amazonaws.com:8000/posts>

Примеры запросов:
- <http://ec2-18-218-151-219.us-east-2.compute.amazonaws.com:8000/posts?order=-id>
- <http://ec2-18-218-151-219.us-east-2.compute.amazonaws.com:8000/posts?limit=25>
- <http://ec2-18-218-151-219.us-east-2.compute.amazonaws.com:8000/posts?offset=10>
- <http://ec2-18-218-151-219.us-east-2.compute.amazonaws.com:8000/posts?order=-id&limit=25&offset=10>


## Парсинг и обновление новостей с  [Hacker News](https://news.ycombinator.com)
Новости загружаются сначала при старте контейнера и далее один раз каждую минуту. Их можно запустить вручную при запущенном контейнере с помощью команды:

    docker exec -it testappfollow_web_1 python3 ./parse_hackernews/parse_hackernews.py

где `testappfollow_web_1` - имя запущенного контейнера.


## Интеграционные API тесты 
Для запуска интеграционных API тестов всех ендпоинтов выполнить в командной строке:

    python3 -m unittest -v test_all_api.py

Эти тесты проверяют все возможные виды запросов. В том числе на те, что упомянуты в вопросах к заданию.
В самом файле `test_all_api.pu` есть параметр URL, с помощью которого можно задавать адрес сервера для тестирования.


## Ответы на вопросы
Что должно произойти, если клиент передал несуществующий атрибут для сортировки.
- вернется ошибка 400 с неправильным атрибутом


Или параметр limit слишком большой? 
- будет урезан до максимально допустимого


А может быть вообще отрицательный? 
- будет равен минимально допустимому


Сортировка возможна в обратном направлении с добавлением знака "-". Например:

    curl -X GET http://localhost:8000/posts?order=-title
    
Если ввести несуществующий адрес, например http://127.0.0.1:8000/, то вернется ошибка 404.
